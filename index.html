<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una invitaci√≥n especial para ti</title>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Dancing+Script:wght@600;700&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink: #ff9fb2;
            --rose: #f78ca2;
            --peach: #ffd4d8;
            --cream: #fff5f7;
            --dark: #5a3d4a;
            --gray: #8b7d82;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #ffeef2 0%, #ffd4d8 50%, #ffcce0 100%);
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            position: relative;
        }

        /* ANIMACI√ìN DE CARGA - CARTA LLEGANDO */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffd4d8 0%, #ffcce0 50%, #ffc4d6 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        #loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .letter-animation {
            position: relative;
            width: 200px;
            height: 140px;
        }

        .flying-envelope {
            position: absolute;
            width: 150px;
            height: 100px;
            background: white;
            border: 3px solid var(--rose);
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: flyIn 2.5s ease-out forwards;
            transform-origin: center;
        }

        .flying-envelope::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            height: 50%;
            background: var(--rose);
            clip-path: polygon(0 0, 50% 60%, 100% 0);
            border-radius: 5px 5px 0 0;
        }

        @keyframes flyIn {
            0% {
                top: -200px;
                left: -200px;
                transform: rotate(-45deg) scale(0.5);
                opacity: 0;
            }
            60% {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(0deg) scale(1);
                opacity: 1;
            }
            100% {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(0deg) scale(1);
                opacity: 1;
            }
        }

        .loading-text {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            color: var(--dark);
            margin-top: 100px;
            animation: fadeInOut 2s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* CORAZONES FLOTANTES DE FONDO */
        .hearts-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }

        .heart {
            position: absolute;
            font-size: 20px;
            opacity: 0;
            color: var(--rose);
            animation: floatHeart 6s ease-in forwards;
        }

        @keyframes floatHeart {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0) rotate(0deg);
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5) rotate(360deg);
            }
        }

        /* PUZZLE DE CORAZONES MEJORADO */
        #puzzle-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffeef2 0%, #ffd4d8 50%, #ffcce0 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0;
            z-index: 100;
            transition: opacity 0.8s ease, visibility 0.8s ease;
            overflow: hidden;
        }

        #puzzle-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .puzzle-header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInDown 0.8s ease-out;
            position: relative;
            padding: 25px 40px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(247, 140, 162, 0.15);
        }

        .puzzle-header::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #f78ca2, #ff9fb2);
            border-radius: 50%;
            animation: floatUp 2s ease-in-out infinite;
        }

        @keyframes floatUp {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-15px); }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .puzzle-title {
            font-family: 'Pacifico', cursive;
            font-size: 2.3rem;
            background: linear-gradient(135deg, #f78ca2, #ff9fb2, #ffc4d6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: bold;
            animation: textGlow 2s ease-in-out infinite;
        }

        @keyframes textGlow {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(247, 140, 162, 0.3)); }
            50% { filter: drop-shadow(0 0 15px rgba(247, 140, 162, 0.6)); }
        }

        .puzzle-instructions {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1rem;
            color: #5a3d4a;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .puzzle-hint {
            font-family: 'Dancing Script', cursive;
            font-size: 1.15rem;
            color: #f78ca2;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .puzzle-password-input {
            width: 320px;
            padding: 18px 25px;
            border: 3px solid var(--rose);
            border-radius: 25px;
            font-size: 1.8rem;
            letter-spacing: 0.4em;
            text-align: center;
            font-weight: bold;
            background: white;
            color: var(--dark);
            box-shadow: 0 15px 40px rgba(247, 140, 162, 0.25);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Courier New', monospace;
            position: relative;
            overflow: hidden;
        }

        .puzzle-password-input::placeholder {
            color: #ffb3c6;
            opacity: 0.8;
        }

        .puzzle-password-input:focus {
            outline: none;
            border-color: #ff9fb2;
            box-shadow: 0 0 35px rgba(247, 140, 162, 0.6), inset 0 0 15px rgba(247, 140, 162, 0.1);
            transform: scale(1.08);
            background: linear-gradient(135deg, rgba(255, 238, 242, 0.5), rgba(255, 212, 216, 0.5));
        }

        .puzzle-password-input:hover:not(:focus) {
            transform: scale(1.02);
            box-shadow: 0 20px 50px rgba(247, 140, 162, 0.35);
        }

        .puzzle-password-input.shake {
            animation: wrongShake 0.5s ease;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(238, 90, 111, 0.1));
        }

        .puzzle-wrapper {
            position: relative;
            margin-bottom: 30px;
            padding: 35px 30px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(247, 140, 162, 0.15);
            border: 2px solid rgba(255, 159, 178, 0.3);
            animation: slideUp 0.8s ease-out 0.3s both;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .puzzle-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            max-width: 320px;
            margin: 0 auto;
        }

        .puzzle-input-label {
            display: block;
            font-size: 0.9rem;
            color: #f78ca2;
            font-weight: 600;
            margin-bottom: 12px;
            font-family: 'Quicksand', sans-serif;
            letter-spacing: 0.5px;
        }

        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(4, 120px);
            gap: 25px;
            position: relative;
            animation: scaleIn 0.6s ease-out 0.3s both;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .heart-piece {
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            border: 4px solid var(--rose);
            border-radius: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            color: var(--dark);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            user-select: none;
            box-shadow: 0 8px 20px rgba(247, 140, 162, 0.2);
        }

        .heart-piece::before {
            content: attr(data-number);
            position: absolute;
            top: 8px;
            right: 12px;
            font-size: 18px;
            color: var(--rose);
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            background: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .heart-piece::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(45deg, var(--pink), var(--rose), var(--peach));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .heart-piece:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 30px rgba(247, 140, 162, 0.4);
        }

        .heart-piece:hover::after {
            opacity: 1;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .heart-piece.waiting {
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .heart-piece.correct {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            border-color: #27ae60;
            color: white;
            animation: correctPulse 0.6s ease, celebrate 0.8s ease;
            pointer-events: none;
            box-shadow: 0 0 30px rgba(46, 204, 113, 0.6);
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes celebrate {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        .heart-piece.wrong {
            animation: wrongShake 0.5s ease;
            background: linear-gradient(145deg, #ff6b6b, #ee5a6f);
            border-color: #e74c3c;
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        /* Part√≠culas de celebraci√≥n */
        .particle {
            position: absolute;
            pointer-events: none;
            font-size: 20px;
            animation: particleFloat 1s ease-out forwards;
        }

        @keyframes particleFloat {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--x), var(--y)) scale(0);
            }
        }
        
        /* Lluvia de corazones de transici√≥n */
        #heart-rain-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 150;
            display: none;
        }
        
        #heart-rain-transition.active {
            display: block;
        }
        
        .rain-heart {
            position: absolute;
            font-size: 30px;
            opacity: 0;
            animation: heartRainUp 2s ease-out forwards;
        }
        
        @keyframes heartRainUp {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0.5) rotate(0deg);
            }
            20% {
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-150px) scale(1.5) rotate(360deg);
            }
        }

        .puzzle-progress-container {
            text-align: center;
            animation: fadeIn 0.8s ease-out 0.5s both;
            padding: 10px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        #puzzle-hint-msg {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            margin-top: 15px;
            min-height: 24px;
            animation: messageSlide 0.4s ease-out;
            box-shadow: 0 5px 20px rgba(247, 140, 162, 0.2);
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #unlock-message {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.2rem;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            box-shadow: 0 8px 30px rgba(46, 204, 113, 0.4);
            animation: successPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes successPop {
            0% {
                opacity: 0;
                transform: scale(0.5) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .puzzle-progress {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.3rem;
            color: var(--dark);
            font-weight: 700;
            background: linear-gradient(145deg, #ffffff, #ffd4d8);
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: inline-block;
        }

        .puzzle-progress span {
            color: var(--rose);
            font-size: 1.5rem;
        }

        .encouragement-message {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            color: var(--rose);
            margin-top: 15px;
            opacity: 0;
            transition: opacity 0.5s ease;
            min-height: 30px;
        }

        .encouragement-message.show {
            opacity: 1;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* ANIMACI√ìN DE CARTA ABRI√âNDOSE CON DESBLOQUEO */
        #letter-opening {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffeef2 0%, #ffd4d8 50%, #ffcce0 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        #letter-opening.show {
            display: flex;
            opacity: 1;
            visibility: visible;
            animation: fadeInBg 0.8s ease;
        }

        @keyframes fadeInBg {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Part√≠culas flotantes para el fondo */
        #letter-opening::before {
            content: '‚ú®';
            position: absolute;
            font-size: 30px;
            top: 20%;
            left: 15%;
            animation: floatParticle1 3s ease-in-out infinite;
            opacity: 0.7;
        }

        #letter-opening::after {
            content: 'üíï';
            position: absolute;
            font-size: 25px;
            top: 70%;
            right: 20%;
            animation: floatParticle2 3.5s ease-in-out infinite;
            opacity: 0.7;
        }

        @keyframes floatParticle1 {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        @keyframes floatParticle2 {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(-10deg); }
        }

        .envelope-container {
            position: relative;
            width: 350px;
            height: 240px;
            perspective: 1200px;
            transform-style: preserve-3d;
            animation: envelopeEntrance 1s ease-out 0.5s both;
            opacity: 0;
        }

        @keyframes envelopeEntrance {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .envelope-back {
            position: absolute;
            width: 350px;
            height: 240px;
            background: linear-gradient(145deg, #ffffff, #ffeef2);
            border: 4px solid var(--rose);
            border-radius: 12px;
            z-index: 1;
            box-shadow: 
                0 15px 35px rgba(247, 140, 162, 0.3),
                0 5px 15px rgba(0,0,0,0.2),
                inset 0 2px 5px rgba(255,255,255,0.5);
            overflow: hidden;
        }

        /* Decoraci√≥n del sobre */
        .envelope-back::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            border: 2px solid var(--pink);
            border-radius: 50%;
            opacity: 0.3;
        }

        .envelope-back::after {
            content: 'üíå';
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 24px;
            opacity: 0.4;
        }

        .envelope-flap {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 175px solid transparent;
            border-right: 175px solid transparent;
            border-bottom: 120px solid var(--rose);
            border-top: 0;
            top: 0;
            left: 0;
            transform-origin: top center;
            z-index: 3;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
            animation: openFlapSmooth 2s cubic-bezier(0.68, -0.55, 0.265, 1.55) 1.5s forwards;
        }

        /* Tri√°ngulo interior de la solapa para efecto 3D */
        .envelope-flap::before {
            content: '';
            position: absolute;
            top: 2px;
            left: -170px;
            width: 0;
            height: 0;
            border-left: 170px solid transparent;
            border-right: 170px solid transparent;
            border-bottom: 115px solid #f78ca2;
        }

        @keyframes openFlapSmooth {
            0% { 
                transform: rotateX(0deg);
                filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
            }
            50% {
                transform: rotateX(-90deg);
            }
            100% { 
                transform: rotateX(-180deg);
                filter: drop-shadow(0 2px 5px rgba(0,0,0,0.1));
            }
        }

        .letter-content {
            position: absolute;
            width: 280px;
            height: 360px;
            background: linear-gradient(180deg, #ffffff, #fffef9);
            border: 3px solid var(--pink);
            border-radius: 10px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -45%);
            z-index: 2;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.25),
                0 5px 10px rgba(247, 140, 162, 0.3);
            animation: slideLetterUpSmooth 2s cubic-bezier(0.34, 1.56, 0.64, 1) 3.2s forwards;
            opacity: 0;
            overflow: hidden;
        }

        /* Decoraci√≥n de la carta */
        .letter-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: repeating-linear-gradient(
                45deg,
                var(--pink),
                var(--pink) 10px,
                var(--rose) 10px,
                var(--rose) 20px
            );
        }

        @keyframes slideLetterUpSmooth {
            0% {
                transform: translate(-50%, -45%) scale(0.95);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            60% {
                transform: translate(-50%, -140%) scale(1.02);
            }
            100% {
                transform: translate(-50%, -145%) scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .letter-paper {
            width: 100%;
            height: 100%;
            padding: 35px 25px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 159, 178, 0.1), transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(255, 212, 216, 0.15), transparent 40%);
        }

        .letter-paper h2 {
            font-family: 'Pacifico', cursive;
            color: var(--rose);
            font-size: 32px;
            margin-bottom: 20px;
            animation: textReveal 0.8s ease 4.7s both;
            text-shadow: 2px 2px 4px rgba(247, 140, 162, 0.2);
        }

        .letter-paper p {
            font-family: 'Dancing Script', cursive;
            color: var(--dark);
            font-size: 22px;
            line-height: 2;
            animation: textReveal 0.8s ease 5s both;
        }

        @keyframes textReveal {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Brillo m√°gico en la carta */
        .letter-shine {
            position: absolute;
            top: -100%;
            left: -100%;
            width: 300%;
            height: 300%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.3) 50%,
                transparent 70%
            );
            animation: shine 3s ease-in-out 1.5s infinite;
        }

        @keyframes shine {
            0%, 100% {
                transform: translateX(-100%) translateY(-100%);
            }
            50% {
                transform: translateX(100%) translateY(100%);
            }
        }

        /* TARJETA PRINCIPAL */
        .card-container {
            position: relative;
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease;
        }

        .card-container.visible {
            opacity: 1;
            pointer-events: auto;
            animation: cardAppear 1s ease-out forwards;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .invitation-card {
            background: white;
            border-radius: 3px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2), inset 0 0 0 1px rgba(247, 140, 162, 0.2);
            padding: 40px 35px;
            max-width: 420px;
            position: relative;
            overflow: hidden;
        }

        .invitation-card::before,
        .invitation-card::after {
            content: "";
            position: absolute;
            background: var(--rose);
            opacity: 0.15;
        }

        .invitation-card::before {
            top: 20px;
            left: 20px;
            right: 20px;
            height: 1px;
        }

        .invitation-card::after {
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 1px;
        }

        .letter-header {
            text-align: right;
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 30px;
            font-family: 'Quicksand', sans-serif;
        }

        h1 {
            font-family: 'Pacifico', cursive;
            color: var(--dark);
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .subtitle {
            font-family: 'Dancing Script', cursive;
            font-size: 1.1rem;
            color: var(--gray);
            text-align: center;
            margin-bottom: 20px;
        }

        .message {
            font-size: 0.95rem;
            color: var(--dark);
            line-height: 1.7;
            margin-bottom: 20px;
            text-align: center;
        }

        .invitation-details {
            background: linear-gradient(135deg, var(--cream) 0%, var(--peach) 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 3px solid var(--pink);
            position: relative;
        }

        .detail-item {
            display: flex;
            align-items: center;
            margin: 12px 0;
            font-size: 0.95rem;
            color: var(--dark);
        }

        .detail-icon {
            width: 10px;
            height: 10px;
            background: var(--rose);
            border-radius: 50%;
            margin-right: 12px;
            min-width: 10px;
        }

        .detail-text {
            flex: 1;
        }

        .detail-title {
            font-weight: 600;
            color: var(--rose);
            font-size: 0.85rem;
            display: block;
            margin-bottom: 3px;
        }

        .btn-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            font-family: 'Quicksand', sans-serif;
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .btn-accept {
            background: linear-gradient(135deg, var(--rose) 0%, var(--pink) 100%);
            color: white;
        }

        .btn-accept:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(247, 140, 162, 0.4);
        }

        .btn-decline {
            background: white;
            color: var(--gray);
            border: 2px solid var(--gray);
        }

        .btn-decline:hover {
            background: var(--cream);
            transform: translateY(-3px);
        }

        /* MODALES */
        .custom-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 450px;
            max-width: 90%;
            background: white;
            padding: 0;
            z-index: 1000;
            border-radius: 35px;
            text-align: center;
            box-shadow: 0 25px 80px rgba(0,0,0,0.25);
            overflow: hidden;
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .custom-modal.show {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .modal-header {
            background: linear-gradient(135deg, #f78ca2 0%, #ff9fb2 50%, #ffc4d6 100%);
            padding: 40px 30px 35px;
            position: relative;
            overflow: hidden;
        }

        .modal-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .modal-header h2 {
            font-family: 'Pacifico', cursive;
            color: white;
            font-size: 2rem;
            margin: 0 0 12px 0;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .modal-header .subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1rem;
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            position: relative;
            z-index: 2;
        }

        .modal-body {
            padding: 45px 35px;
            background: linear-gradient(180deg, #fff5f7 0%, #ffffff 100%);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .modal-body p {
            color: #5a3d4a;
            font-size: 1.05rem;
            margin-bottom: 20px;
            line-height: 1.6;
            font-family: 'Quicksand', sans-serif;
        }

        .modal-body p:last-of-type {
            margin-bottom: 0;
        }

        .modal-body label {
            display: block;
            text-align: left;
            font-weight: 700;
            font-size: 0.95rem;
            color: #f78ca2;
            margin-bottom: 12px;
            font-family: 'Quicksand', sans-serif;
            letter-spacing: 0.5px;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top:0; left:0; width:100%; height:100%;
            background: rgba(90, 61, 74, 0.6);
            backdrop-filter: blur(8px);
            z-index: 999;
            animation: overlayFade 0.3s ease;
        }

        .modal-overlay.show {
            display: block;
        }

        @keyframes overlayFade {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .input-royal {
            width: 100%;
            padding: 16px 18px;
            border: 2px solid #ff9fb2;
            border-radius: 18px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            margin: 8px 0 20px;
            box-sizing: border-box;
            background: white;
            color: var(--dark);
            transition: all 0.3s ease;
        }

        .input-royal:focus {
            outline: none;
            border-color: #f78ca2;
            box-shadow: 0 0 20px rgba(247, 140, 162, 0.4), inset 0 0 10px rgba(247, 140, 162, 0.1);
            transform: translateY(-2px);
        }

        .textarea-royal {
            width: 100%;
            height: 110px;
            border: 2px solid #ff9fb2;
            border-radius: 18px;
            padding: 16px 18px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            box-sizing: border-box;
            background: white;
            color: var(--dark);
            resize: none;
            transition: all 0.3s ease;
            margin: 8px 0 20px;
        }

        .textarea-royal:focus {
            outline: none;
            border-color: #f78ca2;
            box-shadow: 0 0 20px rgba(247, 140, 162, 0.4), inset 0 0 10px rgba(247, 140, 162, 0.1);
            transform: translateY(-2px);
        }

        .btn-royal {
            font-family: 'Quicksand', sans-serif;
            padding: 15px 40px;
            border: none;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 700;
            border-radius: 25px;
            background: linear-gradient(135deg, #f78ca2 0%, #ff9fb2 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(247, 140, 162, 0.35);
            transition: all 0.3s ease;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-royal:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(247, 140, 162, 0.5);
        }

        .btn-royal:active {
            transform: translateY(-2px);
        }

        .btn-royal:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-royal.btn-secondary {
            background: white;
            color: #f78ca2;
            border: 2px solid #f78ca2;
            box-shadow: 0 4px 15px rgba(247, 140, 162, 0.2);
        }

        .btn-royal.btn-secondary:hover {
            background: rgba(247, 140, 162, 0.1);
            box-shadow: 0 8px 25px rgba(247, 140, 162, 0.3);
        }

        .success-msg {
            color: #2d7a2d;
            font-weight: 600;
            display: none;
            margin-top: 15px;
            padding: 12px;
            background: rgba(45, 122, 45, 0.1);
            border-radius: 10px;
        }

        .error-msg {
            color: #c0392b;
            font-size: 0.9rem;
            display: none;
            margin-top: 5px;
            padding: 10px;
            background: rgba(192, 57, 43, 0.1);
            border-radius: 8px;
        }

        .loading {
            display: none;
            color: var(--rose);
            font-style: italic;
            margin-top: 10px;
        }

        .phone-input-wrapper {
            display: flex;
            align-items: center;
            gap: 0;
            margin: 8px 0 18px;
        }

        .phone-prefix {
            background: linear-gradient(135deg, var(--rose), var(--pink));
            color: white;
            padding: 14px 12px;
            border: 2px solid var(--pink);
            border-right: none;
            border-radius: 15px 0 0 15px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            font-weight: 600;
        }

        .phone-input {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid var(--pink);
            border-left: none;
            border-radius: 0 15px 15px 0;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            background: white;
            color: var(--dark);
            transition: all 0.3s ease;
        }

        .phone-input:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(247, 140, 162, 0.3);
        }

        /* Modal de √©xito */
        .success-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 480px;
            max-width: 90%;
            background: white;
            z-index: 1001;
            border-radius: 40px;
            text-align: center;
            box-shadow: 0 30px 100px rgba(0,0,0,0.3);
            overflow: hidden;
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .success-modal.show {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .success-modal-header {
            background: linear-gradient(135deg, #f78ca2, #ff9fb2, #ffc4d6);
            padding: 45px 30px;
            position: relative;
            overflow: hidden;
        }

        .success-modal-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 250px;
            height: 250px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
        }

        .success-icon {
            font-size: 70px;
            margin-bottom: 15px;
            animation: successBounce 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes successBounce {
            0% { transform: scale(0) rotate(-180deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .success-modal-header h2 {
            font-family: 'Pacifico', cursive;
            color: white;
            font-size: 2.2rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.15);
            position: relative;
            z-index: 2;
        }

        .success-modal-body {
            padding: 50px 35px;
            background: linear-gradient(180deg, #fff5f7 0%, #ffffff 100%);
        }

        .success-modal-body p {
            color: #5a3d4a;
            font-size: 1.1rem;
            margin: 0 0 20px;
            line-height: 1.7;
            font-family: 'Quicksand', sans-serif;
        }

        .success-modal-body .highlight {
            background: linear-gradient(135deg, #f78ca2 0%, #ff9fb2 100%);
            color: white;
            padding: 25px 25px;
            border-radius: 20px;
            margin: 30px 0;
            font-weight: 700;
            font-size: 1.05rem;
            line-height: 1.8;
            box-shadow: 0 10px 30px rgba(247, 140, 162, 0.3);
        }

        .btn-close-success {
            font-family: 'Quicksand', sans-serif;
            padding: 16px 50px;
            border: none;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 700;
            border-radius: 28px;
            background: linear-gradient(135deg, #f78ca2, #ff9fb2);
            color: white;
            box-shadow: 0 10px 30px rgba(247, 140, 162, 0.35);
            transition: all 0.3s ease;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-close-success:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 45px rgba(247, 140, 162, 0.5);
        }

        .btn-close-success:active {
            transform: translateY(-2px);
        }

        /* Responsivo */
        @media (max-width: 600px) {
            .invitation-card {
                padding: 30px 25px;
                max-width: 90%;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .puzzle-title {
                font-size: 2rem;
            }
            
            .puzzle-instructions {
                font-size: 1rem;
            }
            
            .puzzle-hint {
                font-size: 0.95rem;
            }
            
            .puzzle-container {
                grid-template-columns: repeat(3, 90px);
                gap: 15px;
                max-width: 320px;
            }
            
            .heart-piece {
                width: 90px;
                height: 90px;
                font-size: 14px;
            }
            
            .envelope-container {
                width: 280px;
                height: 190px;
            }
            
            .envelope-back {
                width: 280px;
                height: 190px;
            }
            
            .envelope-flap {
                border-left: 140px solid transparent;
                border-right: 140px solid transparent;
                border-bottom: 95px solid var(--rose);
            }
            
            .envelope-flap::before {
                left: -136px;
                border-left: 136px solid transparent;
                border-right: 136px solid transparent;
                border-bottom: 90px solid #f78ca2;
            }
            
            .letter-content {
                width: 220px;
                height: 280px;
            }
            
            .letter-paper {
                padding: 25px 20px;
            }
            
            .letter-paper h2 {
                font-size: 24px;
            }
            
            .letter-paper p {
                font-size: 18px;
            }
            
            .heart-piece::before {
                width: 24px;
                height: 24px;
                font-size: 16px;
            }
            
            .puzzle-progress {
                font-size: 1.1rem;
                padding: 12px 25px;
            }
            
            .encouragement-message {
                font-size: 1.1rem;
            }
            
            .detail-item {
                font-size: 0.9rem;
            }
        }

        /* MODAL DE MENSAJE DE AMOR */
        .love-message-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            width: 500px;
            max-width: 95%;
            background: white;
            padding: 50px 40px;
            z-index: 1000;
            border-radius: 35px;
            text-align: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(247, 140, 162, 0.3);
            max-height: 85vh;
            overflow-y: auto;
            animation: modalFadeIn 0.5s ease;
        }

        .love-message-modal.show {
            display: block;
        }

        #love-message {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            line-height: 1.8;
            color: var(--dark);
            text-align: left;
            min-height: 300px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 239, 242, 0.5) 0%, rgba(255, 212, 216, 0.3) 100%);
            border-radius: 20px;
            border-left: 4px solid var(--rose);
            margin-bottom: 20px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .love-message-modal .btn-royal {
            margin-top: 15px;
            background: linear-gradient(135deg, var(--rose) 0%, var(--pink) 100%);
            padding: 12px 35px;
            font-size: 1rem;
        }
    </style>
</head>
<body>

    <!-- Pantalla de carga con carta llegando -->
    <div id="loading-screen">
        <div class="letter-animation">
            <div class="flying-envelope"></div>
        </div>
        <div class="loading-text">Te ha llegado una carta...</div>
    </div>

<!-- Pantalla del puzzle de contrase√±a -->
        <div id="puzzle-screen">
            <div class="puzzle-header">
                <div class="puzzle-title">üîê Desbloquea tu Sorpresa</div>
                <div class="puzzle-instructions">Ingresa el c√≥digo m√°gico de 8 d√≠gitos</div>
                <div class="puzzle-hint">üíù Pista: Nuestras fechas de cumplea√±os unidas üíï</div>
            </div>
            
            <div class="puzzle-wrapper">
                <div class="puzzle-input-wrapper">
                    <div class="puzzle-input-label">Tu C√≥digo Secreto:</div>
                    <input type="password" id="puzzle-input" class="puzzle-password-input" placeholder="‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢" maxlength="8" onkeyup="checkPasswordPuzzle(event)">
                    <p id="puzzle-hint-msg" style="color: #f78ca2; font-size: 0.9rem; margin-top: 15px; min-height: 20px; display: block;"></p>
                </div>
            </div>
            
            <div class="puzzle-progress-container" style="margin-top: 15px;">
                <div id="unlock-message" style="display: none;">‚úì ¬°Correcto! Abriendo tu sorpresa...</div>
            </div>
        </div>
        
        <!-- Animaci√≥n de carta abri√©ndose -->
        <div id="letter-opening">
        <!-- Sobre con carta -->
        <div class="envelope-container">
            <div class="envelope-back"></div>
            <div class="envelope-flap"></div>
            <div class="letter-content">
                <div class="letter-shine"></div>
                <div class="letter-paper">
                    <h2>Para ti</h2>
                    <p>Una invitaci√≥n<br>muy especial<br>te espera...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Corazones de fondo -->
    <div class="hearts-bg" id="hearts-bg"></div>

    <!-- Tarjeta de invitaci√≥n (oculta hasta resolver puzzle) -->
    <div class="card-container" id="card-container">
        <div class="invitation-card">
            <div class="letter-header">
                Febrero 23, 2026
            </div>
            
            <h1>Una Sorpresa Especial</h1>
            <div class="subtitle">Te tengo una sorpresa üéÅ</div>
            
            <p class="message">
                Tengo algo muy especial planeado para ti. Es una sorpresa, as√≠ que necesitar√°s descifrar el c√≥digo para saber m√°s. ¬øTe atreves?
            </p>
            
            <div class="invitation-details">
                <div class="detail-item">
                    <div class="detail-icon"></div>
                    <div class="detail-text">
                        <span class="detail-title">üéÅ UNA SORPRESA</span>
                        <span>Algo muy emocionante te espera</span>
                    </div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-icon"></div>
                    <div class="detail-text">
                        <span class="detail-title">üåü LUGAR MISTERIOSO</span>
                        <span>¬°Un lugar lleno de magia y aventura!</span>
                    </div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-icon"></div>
                    <div class="detail-text">
                        <span class="detail-title">üìÖ FECHA Y HORA</span>
                        <span>Jueves 26 de Febrero, 10:00 AM - 10:30 AM</span>
                    </div>
                </div>
            </div>
            
            <p class="message" style="font-size: 0.85rem; margin-top: 15px;">
                Seria muy feliz si aceptas esta invitacion
            </p>
            
            <div class="btn-container">
                <button class="btn btn-accept" onclick="showBooking(event)">Me encantaria</button>
                <button class="btn btn-decline" onclick="confirmDecline(event)">Tal vez otro dia</button>
            </div>
        </div>
    </div>

    <!-- Modal overlay -->
    <div class="modal-overlay" id="overlay"></div>

    <!-- Modal de aceptaci√≥n -->
    <div class="custom-modal" id="modal-booking">
        <div class="modal-header">
            <h2>Que alegr√≠a</h2>
            <p class="subtitle">Confirma la reserva</p>
        </div>
        
        <div class="modal-body">
            <p>Por favor, d√©jame un mensaje para confirmar nuestra salida:</p>
            
            <label for="final-msg">Un mensaje para mi</label>
            <textarea id="final-msg" class="textarea-royal" placeholder="Escribe algo lindo..." required></textarea>
            
            <p class="error-msg" id="error-accept">Por favor escribe un mensaje</p>
            <p class="loading" id="loading-accept">Enviando...</p>
            <p class="success-msg" id="success-accept">¬°Confirmado con √©xito!</p>
            
            <button class="btn-royal" onclick="sendAcceptEmail()">Confirmar</button>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n de rechazo -->
    <div class="custom-modal" id="modal-decline">
        <div class="modal-header">
            <h2>¬øEst√°s segura?</h2>
            <p class="subtitle">Reconsideralo por favor</p>
        </div>
        
        <div class="modal-body">
            <p>Me har√≠a muy feliz pasar este tiempo contigo...</p>
            <p style="font-size: 0.95rem; color: #8b7d82; margin-top: 10px;">Estoy seguro que la sopresa te va a gustar</p>
            
            <div style="display: flex; gap: 12px; justify-content: center; margin-top: 25px;">
                <button class="btn-royal" onclick="closeDecline()">Esta bien, acepto</button>
                <button class="btn-royal btn-secondary" onclick="showDeclineReason()">Mejor no</button>
            </div>
        </div>
    </div>

    <!-- Modal de raz√≥n de rechazo -->
    <div class="custom-modal" id="modal-decline-reason">
        <div class="modal-header">
            <h2>Entendido</h2>
            <p class="subtitle">Gracias por responder</p>
        </div>
        
        <div class="modal-body">
            <label for="decline-reason">Si quieres, d√©jame un mensaje</label>
            <textarea id="decline-reason" class="textarea-royal" placeholder="Opcional..."></textarea>
            
            <p class="loading" id="loading-decline">Enviando...</p>
            <p class="success-msg" id="success-decline">Mensaje enviado</p>
            
            <button class="btn-royal btn-secondary" onclick="sendDeclineEmail()">Enviar</button>
        </div>
    </div>

    <!-- Modal de mensaje de amor con efecto typewriter -->
    <div class="love-message-modal" id="love-message-modal">
        <div id="love-message"></div>
        <button class="btn-royal" onclick="closeLoveMessageAndShowBooking()">Continuar ‚ô•</button>
    </div>

    <!-- Modal de √©xito -->
    <div class="success-modal" id="success-modal">
        <div class="success-modal-header">
            <h2>¬°Confirmado! üéâ</h2>
        </div>
        <div class="success-modal-body">
            <p>Revisa tu correo para ver los detalles de nuestra sorpresa especial</p>
            
            <div class="highlight">
                Una Sorpresa Especial ‚ú®<br>
                Jueves 26 de Febrero<br>
                10:00 AM - 7:00 PM<br>
                üìç Lugar Misterioso
            </div>
            
            <p style="font-size: 0.95rem;">¬°No puedo esperar para verte y darte la sorpresa! üíï</p>
            
            <button class="btn-close-success" onclick="closeSuccessModal()">Cerrar</button>
        </div>
    </div>

    <!-- Modal de mensaje m√©dico -->
    <div class="success-modal" id="medical-modal">
        <div class="success-modal-header" style="background: linear-gradient(135deg, #3498db, #2980b9);">
            <h2>üìã Aviso Importante</h2>
        </div>
        <div class="success-modal-body">
            <p style="font-size: 1.1rem; color: #2c3e50;">Actualmente estoy en <strong>atenci√≥n m√©dica</strong> recuper√°ndome del pie ü¶µ</p>
            
            <div class="highlight" style="background: linear-gradient(135deg, #ecf0f1, #bdc3c7); color: #2c3e50; border-left: 5px solid #3498db;">
                Me estoy recuperando poco a poco<br>
                No puedo caminar mucho todav√≠a<br>
                Pero te tengo una sorpresa especial üíù
            </div>
            
            <p style="font-size: 0.95rem;">Gracias por tu comprensi√≥n y paciencia üôè</p>
            
            <button class="btn-close-success" onclick="closeMedicalModal()">Entendido üí™</button>
        </div>
    </div>
    <script>
        const YOUR_EMAIL = 'maycoljhorda07@gmail.com';
        const API_URL = '/.netlify/functions/send-email';
        const CORRECT_PASSWORD = '22110709'; // Contrase√±a: fecha de cumplea√±os

        // Animaci√≥n de carga inicial
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('loading-screen').classList.add('hidden');
            }, 3000);
        });

        // Funci√≥n para verificar la contrase√±a
        function checkPasswordPuzzle(event) {
            const input = document.getElementById('puzzle-input');
            const hintMsg = document.getElementById('puzzle-hint-msg');
            const unlockMsg = document.getElementById('unlock-message');
            const value = input.value;

            // Limpiar mensaje anterior
            hintMsg.textContent = '';
            input.classList.remove('shake');

            if (value.length === 0) {
                hintMsg.textContent = '';
                hintMsg.style.color = '#f78ca2';
                return;
            }

            if (value.length < 8) {
                const remaining = 8 - value.length;
                hintMsg.textContent = `${value.length}/8 d√≠gitos... ${remaining} m√°s üëÄ`;
                hintMsg.style.color = '#f78ca2';
                return;
            }

            if (value === CORRECT_PASSWORD) {
                hintMsg.textContent = '‚úì ¬°Correcto! üéâ';
                hintMsg.style.color = '#2ecc71';
                hintMsg.style.fontWeight = '700';
                hintMsg.style.fontSize = '1.1rem';
                unlockMsg.style.display = 'block';
                input.disabled = true;
                input.style.background = 'linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(39, 174, 96, 0.1))';
                input.style.borderColor = '#2ecc71';
                
                // Efecto de celebraci√≥n
                createConfetti();
                
                setTimeout(() => {
                    completePuzzle();
                }, 2000);
            } else {
                hintMsg.textContent = '‚úó C√≥digo incorrecto, intenta de nuevo';
                hintMsg.style.color = '#e74c3c';
                hintMsg.style.fontWeight = '600';
                input.classList.add('shake');
                
                // A√±adir efecto visual de error
                input.style.borderColor = '#e74c3c';
                setTimeout(() => {
                    input.style.borderColor = 'var(--rose)';
                }, 500);
                
                // Limpiar entrada despu√©s de error
                setTimeout(() => {
                    input.value = '';
                    hintMsg.textContent = '';
                }, 600);
            }
        }

        function createConfetti() {
            const container = document.getElementById('puzzle-screen');
            const confetti = ['üéâ', 'üéä', 'üíï', '‚ú®', 'üíñ', '‚≠ê', 'üåü', 'üíù', 'üîì', 'üí´'];
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.textContent = confetti[Math.floor(Math.random() * confetti.length)];
                    particle.style.left = (Math.random() * 100) + '%';
                    particle.style.top = '50%';
                    particle.style.fontSize = (15 + Math.random() * 25) + 'px';
                    
                    const angle = (Math.PI * 2 * i) / 30;
                    const distance = 200 + Math.random() * 100;
                    particle.style.setProperty('--x', Math.cos(angle) * distance + 'px');
                    particle.style.setProperty('--y', Math.sin(angle) * distance + 'px');
                    
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 1200);
                }, i * 20);
            }
        }

        function completePuzzle() {
            // Activar lluvia de corazones
            startHeartRain();
            
            // Ocultar puzzle despu√©s de un momento
            setTimeout(() => {
                document.getElementById('puzzle-screen').classList.add('hidden');
            }, 500);
            
            // Mostrar la invitaci√≥n despu√©s de la lluvia de corazones
            setTimeout(() => {
                document.getElementById('card-container').classList.add('visible');
                document.getElementById('hearts-bg').classList.add('active');
                startHeartAnimation();
            }, 2500);
        }
        
        // Funci√≥n para crear la lluvia de corazones de transici√≥n
        function startHeartRain() {
            const container = document.createElement('div');
            container.id = 'heart-rain-transition';
            container.className = 'active';
            document.body.appendChild(container);
            
            const heartEmojis = ['üíï', 'üíñ', 'üíó', 'üíì', 'üíù', 'üíû', '‚ù§Ô∏è', 'ü©∑'];
            
            // Crear m√∫ltiples oleadas de corazones
            for (let wave = 0; wave < 3; wave++) {
                setTimeout(() => {
                    for (let i = 0; i < 25; i++) {
                        setTimeout(() => {
                            const heart = document.createElement('div');
                            heart.className = 'rain-heart';
                            heart.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
                            heart.style.left = Math.random() * 100 + '%';
                            heart.style.fontSize = (20 + Math.random() * 30) + 'px';
                            heart.style.animationDelay = '0s';
                            heart.style.animationDuration = (1.5 + Math.random() * 0.8) + 's';
                            container.appendChild(heart);
                            
                            setTimeout(() => heart.remove(), 2500);
                        }, i * 30);
                    }
                }, wave * 600);
            }
            
            // Remover el contenedor despu√©s de la animaci√≥n
            setTimeout(() => {
                container.remove();
            }, 3000);
        }

        // Crear corazones flotantes
        function startHeartAnimation() {
            setInterval(() => {
                createHeart();
            }, 800);
        }

        function createHeart() {
            const container = document.getElementById('hearts-bg');
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '‚ô•';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (4 + Math.random() * 2) + 's';
            heart.style.fontSize = (15 + Math.random() * 15) + 'px';
            container.appendChild(heart);
            
            setTimeout(() => heart.remove(), 6000);
        }

        function showBooking(e) {
            e.stopPropagation();
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('overlay').classList.add('show');
            document.getElementById('love-message-modal').classList.add('show');
            startLoveMessageTyping();
        }

        function closeLoveMessageAndShowBooking() {
            document.getElementById('love-message-modal').classList.remove('show');
            document.getElementById('modal-booking').style.display = 'block';
            document.getElementById('modal-booking').classList.add('show');
        }

        function confirmDecline(e) {
            e.stopPropagation();
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('overlay').classList.add('show');
            document.getElementById('modal-decline').style.display = 'block';
            document.getElementById('modal-decline').classList.add('show');
        }

        function closeDecline() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('modal-decline').style.display = 'none';
            document.getElementById('modal-decline').classList.remove('show');
        }

        function showDeclineReason() {
            document.getElementById('modal-decline').style.display = 'none';
            document.getElementById('modal-decline').classList.remove('show');
            document.getElementById('modal-decline-reason').style.display = 'block';
            document.getElementById('modal-decline-reason').classList.add('show');
        }

        function showSuccessModal() {
            document.getElementById('modal-booking').style.display = 'none';
            document.getElementById('modal-booking').classList.remove('show');
            document.getElementById('success-modal').classList.add('show');
        }

        function closeSuccessModal() {
            document.getElementById('success-modal').classList.remove('show');
            document.getElementById('medical-modal').classList.add('show');
        }

        function closeMedicalModal() {
            document.getElementById('medical-modal').classList.remove('show');
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('overlay').classList.remove('show');
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        async function sendAcceptEmail() {
            const message = document.getElementById('final-msg').value.trim();
            const loadingEl = document.getElementById('loading-accept');
            const successEl = document.getElementById('success-accept');
            const errorEl = document.getElementById('error-accept');
            const btn = document.querySelector('#modal-booking .btn-royal');

            if (!message) {
                errorEl.textContent = 'Por favor escribe un mensaje';
                errorEl.style.display = 'block';
                return;
            }
            
            errorEl.style.display = 'none';
            loadingEl.style.display = 'block';
            btn.disabled = true;
            btn.style.opacity = '0.6';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tipo: 'aceptar',
                        guestEmail: YOUR_EMAIL,
                        mensaje: message
                    })
                });

                const result = await response.json();
                loadingEl.style.display = 'none';

                if (result.success) {
                    successEl.style.display = 'block';
                    setTimeout(() => {
                        showSuccessModal();
                    }, 500);
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Error:', error);
                loadingEl.style.display = 'none';
                
                const subject = '‚ù§Ô∏è ACEPTO LA INVITACI√ìN - Sorpresa Especial 26 Febrero';
                const body = `¬°HE ACEPTADO TU INVITACI√ìN! üíï\n\nMi mensaje para ti:\n${message}\n\n---\nSorpresa Especial\nJueves 26 de Febrero, 10:00 AM - 10:30 AM`;
                window.location.href = `mailto:${YOUR_EMAIL}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                successEl.style.display = 'block';
            }
        }

        function startLoveMessageTyping() {
            const messageDiv = document.getElementById('love-message');
            messageDiv.innerHTML = ''; // Limpiar contenido anterior
            
            const fullMessage = `Amor, quiero que sepas que estos d√≠as he sentido much√≠simo tu ausencia. Te extra√±o m√°s de lo que imaginas, en los detalles peque√±os, en los silencios, en los momentos en los que quisiera abrazarte sin decir nada. Me haces falta de una forma bonita, de esas que nacen cuando alguien ya ocupa un lugar profundo en el coraz√≥n.\n\nEsta salida va a ser diferente a todas las dem√°s‚Ä¶ no ser√° solo una cita, ser√° una peque√±a aventura. Esta vez tendr√°s que encontrarme, seguir las pistas, dejarte sorprender. Ya sabr√°s c√≥mo ser√° cuando llegue el momento, pero te prometo que estar√° llena de emoci√≥n, risas y esa complicidad tan nuestra.\n\nTe amo. Y todo lo que preparo para ti nace exactamente de eso, te amo ratoncita jsjs`;
            
            let index = 0;
            const typingSpeed = 30; // Velocidad de escritura en ms
            
            function typeCharacter() {
                if (index < fullMessage.length) {
                    const char = fullMessage[index];
                    if (char === '\\n') {
                        messageDiv.innerHTML += '<br>';
                    } else {
                        messageDiv.innerHTML += char;
                    }
                    index++;
                    messageDiv.scrollTop = messageDiv.scrollHeight; // Auto-scroll
                    setTimeout(typeCharacter, typingSpeed);
                }
            }
            
            typeCharacter();
        }

        async function sendDeclineEmail() {
            const reason = document.getElementById('decline-reason').value.trim();
            const loadingEl = document.getElementById('loading-decline');
            const successEl = document.getElementById('success-decline');
            const btn = document.querySelector('#modal-decline-reason .btn-royal');

            if (!reason) {
                return;
            }

            loadingEl.style.display = 'block';
            btn.disabled = true;
            btn.style.opacity = '0.6';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tipo: 'declinar',
                        guestEmail: YOUR_EMAIL,
                        mensaje: reason
                    })
                });

                const result = await response.json();
                loadingEl.style.display = 'none';

                if (result.success) {
                    successEl.style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('overlay').style.display = 'none';
                        document.getElementById('modal-decline-reason').style.display = 'none';
                    }, 1500);
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Error:', error);
                loadingEl.style.display = 'none';
                
                const subject = 'üíî No podr√© ir - Sorpresa Especial 26 Febrero';
                const body = `Lo siento, no podr√© asistir.\n\nMi mensaje:\n${reason || '(Sin mensaje)'}\n\n---\nSorpresa Especial\nJueves 26 de Febrero, 10:00 AM - 10:30 AM`;
                window.location.href = `mailto:${YOUR_EMAIL}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                successEl.style.display = 'block';
                setTimeout(() => {
                    document.getElementById('overlay').style.display = 'none';
                    document.getElementById('modal-decline-reason').style.display = 'none';
                }, 1500);
            }
        }
    </script>
</body>
</html>